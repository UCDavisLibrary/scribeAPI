<section class="row align-center toolbar admin">
  <a class="secondary button" href="/admin">Admin Dashboard</a>
  <a class="secondary button" href="/browse">Catalogue</a>
  <a class="secondary button" href="#">Log Out </a>
</section>

<section class="small-12 medium-10 medium-offset-1 large-8 large-offset-2 columns">
  <h2>Admin</h2>
  <p>Here's how we're doing so far:</p>
  <div class="row">
    <div class="pie-chart large-9 columns">
      <div id="chart"></div>
      <script>
	var data = <%= raw @stats[:graphable_data].to_json %>;

	var w = 400
	    h = 400,
	    r = h/2;

	var color = d3.scale.ordinal()
	   .range(["#039317", "#921377", "#E6E6E6", "#214BB5"]);
	
	var vis = d3.select('#chart')
	   .append("svg:svg")
	   .data([data])
	   .attr("width", w)
	   .attr("height", h)
	   .append("svg:g")
   	   .attr("transform", "translate(" + r + "," + r + ")");
	
	var pie = d3.layout.pie().value(function(d){return d.value;});

	// declare an arc generator function
	var arc = d3.svg.arc().outerRadius(r - 10).innerRadius(r - 110);

	// select paths, use arc generator to draw
	var arcs = vis.selectAll("g.slice").data(pie).enter().append("svg:g").attr("class", "slice");
	arcs.append("svg:path")
  	  .attr("fill", function(d, i){
              return color(i);
	})
	.attr("d", function (d) {
          return arc(d);
	});
	
	// add the text
	arcs.append("svg:text").attr("transform", function(d) {
	  d.innerRadius = r;
	  d.outerRadius = r;
	return "translate(" + arc.centroid(d) + ")";}).attr("text-anchor", "middle").attr("fill", "white")
	  .style("text-transform", "uppercase")
	  .text(function(d, i) {
  	     if (data[i].value > 0) {
    	       return data[i].label;
  	   }
	});

      </script>
    </div>
    <div class="status-list columns">
      <dl>
	<dd><%= @stats[:completion_data][:verifies] %></dd>
	<dt>Verified labels</dt>
	<dd><%= @stats[:completion_data][:marks] %></dd>
	<dt>Marked labels</dt>
	<dd><%= @stats[:completion_data][:transcribes] %></dd>
	<dt>Transcribed labels</dt>
      </dl>
    </div>
  </div>
</section>
